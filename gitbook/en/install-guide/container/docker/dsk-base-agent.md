# dsk-base-agent

## Install DataSaker Base agent in Docker environment

`Base agent` collects various information generated by the server in real time. For example, you can collect various information such as server performance indicators such as memory and CPU usage, network traffic, and container information. Through this, customers can monitor the server's status in real time, and based on this, optimize the server's performance and increase stability. We tailor agent settings to your needs to deliver optimal results.

## Did you run the DataSaker predecessor?

If the preceding task of `DataSaker` has not been carried out in the current Docker environment, please proceed with the preceding task of `DataSaker` first. [DataSaker predecessor](README.md)

## Install the base agent

Setting up a cluster ID allows you to manage resources as logical groups. If the cluster ID is not set, 'unknown' is set by default.

To set the cluster ID, you need to set the environment variable as follows.
```shell
export DSK_CLUSTER_ID=my-cluster
```
1. Create a local directory for datasaker to use.
```shell
   sudo mkdir -p /var/datasaker
   sudo chown -R datasaker:datasaker /var/datasaker/ 
```
2. Enter the docker command into the server.
```shell
docker run -d --name dsk-node-agent\
   -v /var/datasaker/:/var/datasaker/\
   -v /proc/:/host/proc/:ro\
   -v /sys/:/host/sys/:ro\
   -v ~/.datasaker/config.yml:/etc/datasaker/global-config.yml:ro\
   -e DSK_CLUSTER_ID=${DSK_CLUSTER_ID} \
   --privileged\
   --restart=always\
   --network host\
   --pid host\
   datasaker/dsk-node-agent
docker run -d --name dsk-container-agent\
   -v /var/datasaker/:/var/datasaker/\
   -v /:/rootfs/:ro\
   -v /var/run/:/var/run/:ro\
   -v /sys/:/sys/:ro\
   -v /dev/disk/:/dev/disk/:ro\
   -v ~/.datasaker/config.yml:/etc/datasaker/global-config.yml:ro\
   -e DSK_CLUSTER_ID=${DSK_CLUSTER_ID} \
   -e GOMAXPROCS=1\
   --privileged\
   --restart=always\
   datasaker/dsk-container-agent

sudo chown -R datasaker:datasaker /var/datasaker/ 
```
